<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#0ea5e9" />
    <title>Ben and Millys Dashboard</title>

    <!-- Tailwind via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Favicons (optional) -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='3' width='18' height='18' rx='3'/%3E%3Cpath d='M7 7h10v10H7z'/%3E%3C/svg%3E" />

    <style>
      /* Safe-area padding for iOS notch */
      .safe-area {
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
        padding-bottom: env(safe-area-inset-bottom);
      }

      /* Simple fade utility for splash */
      .fade-out { opacity: 0; transition: opacity .5s ease; }
    </style>
  </head>
  <body class="bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100 selection:bg-sky-200/60 selection:text-slate-900">
    <!-- Splash / Loading Screen -->
    <div id="splash" class="fixed inset-0 z-50 flex items-center justify-center bg-slate-900 text-white">
      <div class="flex flex-col items-center gap-4">
        <div class="h-14 w-14 rounded-2xl bg-gradient-to-br from-sky-400 to-blue-600 grid place-items-center animate-pulse">
          <!-- App glyph -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-7 w-7" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="3"/><path d="M7 7h10v10H7z"/></svg>
        </div>
        <p class="text-sm tracking-wide text-white/80">Loading your dashboardâ€¦</p>
      </div>
    </div>
    <!-- Hide splash if JS is disabled -->
    <noscript><style>#splash{display:none!important}</style></noscript>

    <!-- App Header -->
    <header class="safe-area sticky top-0 z-20 bg-slate-50/80 backdrop-blur supports-[backdrop-filter]:bg-slate-50/60 dark:bg-slate-900/70 border-b border-slate-200/70 dark:border-slate-800">
      <div class="mx-auto max-w-screen-sm px-4 py-3">
        <div class="flex items-center gap-3">
          <div class="h-9 w-9 rounded-xl bg-gradient-to-br from-sky-400 to-blue-600 grid place-items-center text-white">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="3"/><path d="M7 7h10v10H7z"/></svg>
          </div>
          <div class="flex-1">
            <h1 class="text-lg font-semibold">Redpath Websites</h1>
            <p class="text-xs text-slate-500 dark:text-slate-400">Tap an icon to open a site</p>
          </div>
        </div>

        <!-- Search -->
        <div class="mt-3">
          <label for="search" class="sr-only">Search sites</label>
          <div class="relative">
            <input id="search" type="search" placeholder="Search sites" class="w-full rounded-2xl border border-slate-200 dark:border-slate-700 bg-white/70 dark:bg-slate-800/70 px-4 py-2.5 pr-10 text-[15px] outline-none focus:ring-2 focus:ring-sky-400" />
            <svg xmlns="http://www.w3.org/2000/svg" class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
          </div>
        </div>
      </div>
    </header>

    <!-- Grid of Sites -->
    <main class="mx-auto max-w-screen-sm px-4 py-4 pb-24">
      <section id="sites" class="grid grid-cols-2 sm:grid-cols-3 gap-4">

        <!-- CALENDAR -->
        <a href="pages/calendar.html" class="group block rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800 p-4 shadow-sm hover:shadow-md transition-shadow focus:outline-none focus:ring-2 focus:ring-sky-400" data-name="Calendar">
          <div class="flex items-center gap-4">
            <div class="h-12 w-12 rounded-xl grid place-items-center bg-sky-50 text-sky-600 group-hover:bg-sky-100 dark:bg-sky-900/30 dark:text-sky-300">
              <!-- Icon: Calendar -->
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
            </div>
            <div class="min-w-0">
              <h2 class="text-sm font-semibold truncate">Calendar</h2>
              <p class="text-xs text-slate-500 dark:text-slate-400 truncate">calendar.html</p>
            </div>
          </div>
        </a>

        <!-- GYM -->
        <a href="pages/gym.html" class="group block rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-800 p-4 shadow-sm hover:shadow-md transition-shadow" data-name="Fitness">
          <div class="flex items-center gap-4">
            <div class="h-12 w-12 rounded-xl grid place-items-center bg-violet-50 text-violet-600 group-hover:bg-violet-100 dark:bg-violet-900/30 dark:text-violet-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-label="Gym">
            <!-- Bar -->
            <path d="M2 12h5M17 12h5"/>
            <!-- Plates -->
            <rect x="7" y="9" width="2" height="6" rx="1"/>
            <rect x="9" y="7" width="4" height="10" rx="1"/>
            <rect x="13" y="9" width="2" height="6" rx="1"/>
            </svg>
            </div>
            <div class="min-w-0">
              <h2 class="text-sm font-semibold truncate">Fitness</h2>
              <p class="text-xs text-slate-500 dark:text-slate-400 truncate">gym.html</p>
            </div>
          </div>
        </a>


    <!-- Bottom bar (optional) -->
    <nav class="safe-area fixed bottom-0 inset-x-0 z-10 bg-white/90 dark:bg-slate-800/90 backdrop-blur border-t border-slate-200 dark:border-slate-700">
      <div class="mx-auto max-w-screen-sm px-6 py-2">
        <div class="flex items-center justify-between text-sm">
          <a href="#" class="font-medium text-sky-600">Dashboard</a>
          <button id="editToggle" class="px-3 py-1 rounded-xl border border-slate-300 dark:border-slate-600">Edit</button>
        </div>
      </div>
    </nav>

    <!-- Tiny JS: splash, search filter, simple edit mode to reorder (drag) -->
    <script>
      // --- Robust splash handling ---
      (function(){
        let hidden = false;
        function hideSplash(){
          if (hidden) return; hidden = true;
          const s = document.getElementById('splash');
          if (!s) return;
          s.classList.add('fade-out');
          setTimeout(() => s.remove(), 500);
        }
        // If DOM is ready, start a short delay then hide.
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          setTimeout(hideSplash, 700);
        } else {
          document.addEventListener('DOMContentLoaded', () => setTimeout(hideSplash, 700));
          window.addEventListener('load', () => setTimeout(hideSplash, 100));
        }
        // Absolute fallback in case 'load' never fires (e.g., CDN blocked)
        setTimeout(hideSplash, 2500);
      })();

      // Search filter
      const search = document.getElementById('search');
      const grid = document.getElementById('sites');
      const tiles = Array.from(grid.querySelectorAll('[data-name]'));
      if (search) {
        search.addEventListener('input', () => {
          const q = search.value.trim().toLowerCase();
          tiles.forEach(t => {
            const name = t.dataset.name.toLowerCase();
            t.style.display = name.includes(q) ? '' : 'none';
          });
        });
      }

      // Simple edit/reorder (drag & drop)
      let editMode = false;
      const editBtn = document.getElementById('editToggle');
      if (editBtn) {
        editBtn.addEventListener('click', () => {
          editMode = !editMode; editBtn.textContent = editMode ? 'Done' : 'Edit';
          tiles.forEach(t => t.draggable = editMode);
          grid.classList.toggle('cursor-move', editMode);
        });
      }

      let dragSrc;
      grid.addEventListener('dragstart', (e) => {
        if (!editMode) return; 
        dragSrc = e.target.closest('a');
        if (!dragSrc) return;
        e.dataTransfer.effectAllowed = 'move';
      });
      grid.addEventListener('dragover', (e) => {
        if (!editMode) return; 
        e.preventDefault();
        const target = e.target.closest('a');
        if (!target || target === dragSrc) return;
        const rect = target.getBoundingClientRect();
        const next = (e.clientY - rect.top) / (rect.height) > 0.5;
        grid.insertBefore(dragSrc, next ? target.nextSibling : target);
      });
      grid.addEventListener('drop', (e) => e.preventDefault());
    </script>
  </body>
</html>
